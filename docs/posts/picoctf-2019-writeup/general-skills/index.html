<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		 
			
  
    <meta name="twitter:card" content="summary"/>
    
      <meta name="twitter:image" content="https://tcode2k16.github.io/blog/images/avatar.png" />
    
  
  
  <meta name="twitter:title" content="PicoCTF 2019 Writeup: General Skills"/>
  <meta name="twitter:description" content="solves for picoCTF 2019 General Skills challenges"/>
  
    <meta name="twitter:site" content="@tcode2k16"/>
  
  
  
  
    <meta name="twitter:creator" content="@Alan Chang"/>
  



		
		<meta name="author" content="Alan Chang">
		<meta name="description" content="a random blog about cybersecurity and programming">
		<meta name="generator" content="Hugo 0.58.2" />
		<title>PicoCTF 2019 Writeup: General Skills &middot; Alan&#39;s Blog</title>
		<link rel="shortcut icon" href="https://tcode2k16.github.io/blog/images/favicon.ico">
		<link rel="stylesheet" href="https://tcode2k16.github.io/blog/css/style.css">
		<link rel="stylesheet" href="https://tcode2k16.github.io/blog/css/highlight.css">

		
		<link rel="stylesheet" href="https://tcode2k16.github.io/blog/css/font-awesome.min.css">
		

		
		<link href="https://tcode2k16.github.io/blog/index.xml" rel="alternate" type="application/rss+xml" title="Alan&#39;s Blog" />
		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://tcode2k16.github.io/blog/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://tcode2k16.github.io/blog/posts'>Archive</a>
	<a href='https://tcode2k16.github.io/blog/tags'>Tags</a>
	<a href='https://tcode2k16.github.io/blog/about'>About</a>

	

	
	<a class="cta" href="https://tcode2k16.github.io/blog/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        PicoCTF 2019 Writeup: General Skills
                    </h1>
                    <h2 class="headline">
                    Oct 12, 2019 13:06
                    · 1069 words
                    · 6 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="https://tcode2k16.github.io/blog/tags/ctf">ctf</a>
                          
                              <a href="https://tcode2k16.github.io/blog/tags/cyber-security">cyber-security</a>
                          
                              <a href="https://tcode2k16.github.io/blog/tags/write-up">write-up</a>
                          
                              <a href="https://tcode2k16.github.io/blog/tags/picoctf">picoctf</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                  
                    <div id="toc">
                      <nav id="TableOfContents">
<ul>
<li><a href="#2warm">2Warm</a>
<ul>
<li><a href="#problem">Problem</a></li>
<li><a href="#solution">Solution</a></li>
</ul></li>
<li><a href="#lets-warm-up">Lets Warm Up</a>
<ul>
<li><a href="#problem-1">Problem</a></li>
<li><a href="#solution-1">Solution</a></li>
</ul></li>
<li><a href="#warmed-up">Warmed Up</a>
<ul>
<li><a href="#problem-2">Problem</a></li>
<li><a href="#solution-2">Solution</a></li>
</ul></li>
<li><a href="#bases">Bases</a>
<ul>
<li><a href="#problem-3">Problem</a></li>
<li><a href="#solution-3">Solution</a></li>
</ul></li>
<li><a href="#first-grep">First Grep</a>
<ul>
<li><a href="#problem-4">Problem</a></li>
<li><a href="#solution-4">Solution</a></li>
</ul></li>
<li><a href="#resources">Resources</a>
<ul>
<li><a href="#problem-5">Problem</a></li>
<li><a href="#solution-5">Solution</a></li>
</ul></li>
<li><a href="#strings-it">strings it</a>
<ul>
<li><a href="#problem-6">Problem</a></li>
<li><a href="#solution-6">Solution</a></li>
</ul></li>
<li><a href="#what-s-a-net-cat">what&rsquo;s a net cat?</a>
<ul>
<li><a href="#problem-7">Problem</a></li>
<li><a href="#solution-7">Solution</a></li>
</ul></li>
<li><a href="#based">Based</a>
<ul>
<li><a href="#problem-8">Problem</a></li>
<li><a href="#solution-8">Solution</a></li>
</ul></li>
<li><a href="#first-grep-part-ii">First Grep: Part II</a>
<ul>
<li><a href="#problem-9">Problem</a></li>
<li><a href="#solution-9">Solution</a></li>
</ul></li>
<li><a href="#plumbing">plumbing</a>
<ul>
<li><a href="#problem-10">Problem</a></li>
<li><a href="#solution-10">Solution</a></li>
</ul></li>
<li><a href="#whats-the-difference">whats-the-difference</a>
<ul>
<li><a href="#problem-11">Problem</a></li>
<li><a href="#solution-11">Solution</a></li>
</ul></li>
<li><a href="#where-is-the-file">where-is-the-file</a>
<ul>
<li><a href="#problem-12">Problem</a></li>
<li><a href="#solution-12">Solution</a></li>
</ul></li>
<li><a href="#flag-shop">flag_shop</a>
<ul>
<li><a href="#problem-13">Problem</a></li>
<li><a href="#solution-13">Solution</a></li>
</ul></li>
<li><a href="#mus1c">mus1c</a>
<ul>
<li><a href="#problem-14">Problem</a></li>
<li><a href="#solution-14">Solution</a></li>
</ul></li>
<li><a href="#1-wanna-b3-a-r0ck5tar">1_wanna_b3_a_r0ck5tar</a>
<ul>
<li><a href="#problem-15">Problem</a></li>
<li><a href="#solution-15">Solution</a></li>
</ul></li>
</ul>
</nav>
                    </div>
                  
                
                <section id="post-body">
                    

<h1 id="2warm">2Warm</h1>

<h2 id="problem">Problem</h2>

<p>Can you convert the number 42 (base 10) to binary (base 2)?</p>

<h2 id="solution">Solution</h2>

<pre><code>$ python
&gt;&gt;&gt; bin(42)
'0b101010'
</code></pre>

<p>flag: <code>picoCTF{101010}</code></p>

<h1 id="lets-warm-up">Lets Warm Up</h1>

<h2 id="problem-1">Problem</h2>

<p>If I told you a word started with 0x70 in hexadecimal, what would it start with in ASCII?</p>

<h2 id="solution-1">Solution</h2>

<pre><code>$ python
&gt;&gt;&gt; chr(0x70)
'p'
</code></pre>

<p>flag: <code>picoCTF{p}</code></p>

<h1 id="warmed-up">Warmed Up</h1>

<h2 id="problem-2">Problem</h2>

<p>What is 0x3D (base 16) in decimal (base 10).</p>

<h2 id="solution-2">Solution</h2>

<pre><code>$ python
&gt;&gt;&gt; 0x3d
61
</code></pre>

<p>flag: <code>picoCTF{61}</code></p>

<h1 id="bases">Bases</h1>

<h2 id="problem-3">Problem</h2>

<p>What does this <code>bDNhcm5fdGgzX3IwcDM1</code>mean? I think it has something to do with bases.</p>

<h2 id="solution-3">Solution</h2>

<p>The flag is encoded with <a href="https://en.wikipedia.org/wiki/Base64">base64</a>.</p>

<pre><code>$ echo &quot;bDNhcm5fdGgzX3IwcDM1&quot; | base64 -d -
l3arn_th3_r0p35
</code></pre>

<p>flag: <code>picoCTF{l3arn_th3_r0p35}</code></p>

<h1 id="first-grep">First Grep</h1>

<h2 id="problem-4">Problem</h2>

<p>Can you find the flag in file? This would be really tedious to look through manually, something tells me there is a better way. You can also find the file in /problems/first-grep_3_2e09f586a51352180a37e25913f5e5d9 on the shell server.</p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/First Grep/file">file</a></p>

<h2 id="solution-4">Solution</h2>

<p>As suggested by the challenge name, we can use the bash command <a href="https://tldr.ostera.io/grep">grep</a> to search for the flag:</p>

<pre><code>$ grep pico file 
picoCTF{grep_is_good_to_find_things_eda8911c}
</code></pre>

<p>flag: <code>picoCTF{grep_is_good_to_find_things_eda8911c}</code></p>

<h1 id="resources">Resources</h1>

<h2 id="problem-5">Problem</h2>

<p>We put together a bunch of resources to help you out on our website! If you go over there, you might even find a flag! <a href="https://picoctf.com/resources">https://picoctf.com/resources</a> (link)</p>

<h2 id="solution-5">Solution</h2>

<p>The flag is on the resources page.</p>

<p>flag: <code>picoCTF{r3source_pag3_f1ag}</code></p>

<h1 id="strings-it">strings it</h1>

<h2 id="problem-6">Problem</h2>

<p>Can you find the flag in file without running it? You can also find the file in /problems/strings-it_5_1fd17da9526a76a4fffce289dee10fbb on the shell server.</p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/strings it/">file</a></p>

<h2 id="solution-6">Solution</h2>

<p>We can find the flag with a combination of <a href="https://tldr.ostera.io/strings">strings</a> and <a href="https://tldr.ostera.io/grep">grep</a>:</p>

<pre><code>$ strings strings | grep pico
picoCTF{5tRIng5_1T_dd38f284}
</code></pre>

<p>flag: <code>picoCTF{5tRIng5_1T_dd38f284}</code></p>

<h1 id="what-s-a-net-cat">what&rsquo;s a net cat?</h1>

<h2 id="problem-7">Problem</h2>

<p>Using netcat (nc) is going to be pretty important. Can you connect to <code>2019shell1.picoctf.com</code> at port <code>4158</code> to get the flag?</p>

<h2 id="solution-7">Solution</h2>

<p>Use the netcat or <a href="https://tldr.ostera.io/nc">nc</a> command:</p>

<pre><code>$ nc 2019shell1.picoctf.com 4158
You're on your way to becoming the net cat master
picoCTF{nEtCat_Mast3ry_700da9c7}
</code></pre>

<p>flag: <code>picoCTF{nEtCat_Mast3ry_700da9c7}</code></p>

<h1 id="based">Based</h1>

<h2 id="problem-8">Problem</h2>

<p>To get truly 1337, you must understand different data encodings, such as hexadecimal or binary. Can you get the flag from this program to prove you are on the way to becoming 1337? Connect with <code>nc 2019shell1.picoctf.com 20836</code>.</p>

<h2 id="solution-8">Solution</h2>

<p>For this challenge, you have to decode base2, base8, and base16 data. I wrote a short script to automate the process:</p>

<pre><code class="language-python">from pwn import *

sh = remote('2019shell1.picoctf.com', 20836)

binary_data = sh.recvuntil('Input:\n').split('\n')[2].split(' ')[3:-3]
binary_data = ''.join(map(lambda x: chr(int(x, 2)), binary_data))
sh.sendline(binary_data)

oct_data = sh.recvuntil('Input:\n').split('\n')[0].split('the  ')[-1].split(' as')[0].split(' ')
oct_data = ''.join(map(lambda x: chr(int(x, 8)), oct_data))
sh.sendline(oct_data)

hex_data = sh.recvuntil('Input:\n').split('\n')[0].split('the ')[-1].split(' as')[0]
hex_data = hex_data.decode('hex')
sh.sendline(hex_data)

sh.interactive()
</code></pre>

<p>flag: <code>picoCTF{learning_about_converting_values_6cdcad0d}</code></p>

<h1 id="first-grep-part-ii">First Grep: Part II</h1>

<h2 id="problem-9">Problem</h2>

<p>Can you find the flag in /problems/first-grep&ndash;part-ii_4_ca16fbcd16c92f0cb1e376a6c188d58f/files on the shell server? Remember to use grep.</p>

<h2 id="solution-9">Solution</h2>

<p>We can use the <code>-r</code> option in <code>grep</code> to search recursively for the flag:</p>

<pre><code>alanc@pico-2019-shell1:/problems/first-grep--part-ii_4_ca16fbcd16c92f0cb1e376a6c188d58f/files$ grep -r pico .
./files6/file5:picoCTF{grep_r_to_find_this_0e28f3ee}
</code></pre>

<p>flag: <code>picoCTF{grep_r_to_find_this_0e28f3ee}</code></p>

<h1 id="plumbing">plumbing</h1>

<h2 id="problem-10">Problem</h2>

<p>Sometimes you need to handle process data outside of a file. Can you find a way to keep the output from this program and search for the flag? Connect to <code>2019shell1.picoctf.com 57911</code>.</p>

<h2 id="solution-10">Solution</h2>

<p>We can use the pipe operator to <code>grep</code> for the flag:</p>

<pre><code>$ nc 2019shell1.picoctf.com 57911 | grep pico
picoCTF{digital_plumb3r_931b2271}
</code></pre>

<p>flag: <code>picoCTF{digital_plumb3r_931b2271}</code></p>

<h1 id="whats-the-difference">whats-the-difference</h1>

<h2 id="problem-11">Problem</h2>

<p>Can you spot the difference? kitters cattos. They are also available at /problems/whats-the-difference_0_00862749a2aeb45993f36cc9cf98a47a on the shell server</p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/whats-the-difference/kitters.jpg">kitters</a></p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/whats-the-difference/cattos.jpg">cattos</a></p>

<h2 id="solution-11">Solution</h2>

<p>The flag is all the bytes that differ between the two files. It can be extracted with a python script:</p>

<pre><code class="language-python">with open('./kitters.jpg', 'rb') as f:
  kitters = f.read()

with open('./cattos.jpg', 'rb') as f:
  cattos = f.read()

flag = ''
for i in range(min(len(kitters), len(cattos))):
  if kitters[i] != cattos[i]:
    flag += cattos[i]
print flag
</code></pre>

<p>flag: <code>picoCTF{th3yr3_a5_d1ff3r3nt_4s_bu773r_4nd_j311y_aslkjfdsalkfslkflkjdsfdszmz10548}</code></p>

<h1 id="where-is-the-file">where-is-the-file</h1>

<h2 id="problem-12">Problem</h2>

<p>I&rsquo;ve used a super secret mind trick to hide this file. Maybe something lies in /problems/where-is-the-file_4_f26b413d005c16c61f127740ab242b35.</p>

<h2 id="solution-12">Solution</h2>

<p>On unix systems, files that start with a <code>.</code> are hidden by default. We can see these files by using the <code>-a</code> option in <code>ls</code>:</p>

<pre><code>alanc@pico-2019-shell1:/problems/where-is-the-file_4_f26b413d005c16c61f127740ab242b35$ ls -a
.  ..  .cant_see_me
alanc@pico-2019-shell1:/problems/where-is-the-file_4_f26b413d005c16c61f127740ab242b35$ cat .cant_see_me 
picoCTF{w3ll_that_d1dnt_w0RK_cb4a5081}
</code></pre>

<p>flag: <code>picoCTF{w3ll_that_d1dnt_w0RK_cb4a5081}</code></p>

<h1 id="flag-shop">flag_shop</h1>

<h2 id="problem-13">Problem</h2>

<p>There&rsquo;s a flag shop selling stuff, can you buy a flag? Source. Connect with <code>nc 2019shell1.picoctf.com 3967</code>.</p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/flag_shop/store.c">source</a></p>

<h2 id="solution-13">Solution</h2>

<p>By reading the source code, we see that the <code>total_cost</code> is stored as a 4 byte signed integer:</p>

<pre><code class="language-c">if(number_flags &gt; 0){
    int total_cost = 0;
    total_cost = 900*number_flags;
    printf(&quot;\nThe final cost is: %d\n&quot;, total_cost);
    if(total_cost &lt;= account_balance){
        account_balance = account_balance - total_cost;
        printf(&quot;\nYour current balance after transaction: %d\n\n&quot;, account_balance);
    }
    else{
        printf(&quot;Not enough funds to complete purchase\n&quot;);
    }
}
</code></pre>

<p>If we enter a large number for <code>number_flags</code>, <code>900*number_flags</code> would overflow and turn into a large negative number:</p>

<pre><code>$ python
&gt;&gt;&gt; ((1&lt;&lt;31)//900)*1.5
3579138.0
</code></pre>

<pre><code>$ nc 2019shell1.picoctf.com 3967
Welcome to the flag exchange
We sell flags

1. Check Account Balance

2. Buy Flags

3. Exit

 Enter a menu selection
2
Currently for sale
1. Defintely not the flag Flag
2. 1337 Flag
1
These knockoff Flags cost 900 each, enter desired quantity
3579138

The final cost is: -1073743096

Your current balance after transaction: 1073744196

Welcome to the flag exchange
We sell flags

1. Check Account Balance

2. Buy Flags

3. Exit

 Enter a menu selection
2
Currently for sale
1. Defintely not the flag Flag
2. 1337 Flag
2
1337 flags cost 100000 dollars, and we only have 1 in stock
Enter 1 to buy one1
YOUR FLAG IS: picoCTF{m0n3y_bag5_cd0ead78}
</code></pre>

<p>flag: <code>picoCTF{m0n3y_bag5_cd0ead78}</code></p>

<h1 id="mus1c">mus1c</h1>

<h2 id="problem-14">Problem</h2>

<p>I wrote you a song. Put it in the picoCTF{} flag format</p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/mus1c/lyrics.txt">file</a></p>

<h2 id="solution-14">Solution</h2>

<p>The given file is a program written in the esoteric language <a href="https://esolangs.org/wiki/Rockstar">rockstar</a>. We can run the program using <a href="https://codewithrockstar.com/online">this website</a>:</p>

<pre><code>Output:
114
114
114
111
99
107
110
114
110
48
49
49
51
114
</code></pre>

<p>A quick conversion from decimal to ascii gives us the flag:</p>

<pre><code>$ python
&gt;&gt;&gt; '''114
... 114
... 114
... 111
... 99
... 107
... 110
... 114
... 110
... 48
... 49
... 49
... 51
... 114'''.strip().split('\n')
['114', '114', '114', '111', '99', '107', '110', '114', '110', '48', '49', '49', '51', '114']
&gt;&gt;&gt; ''.join(map(chr,map(int,_)))
'rrrocknrn0113r'
</code></pre>

<p>flag: <code>picoCTF{rrrocknrn0113r}</code></p>

<h1 id="1-wanna-b3-a-r0ck5tar">1_wanna_b3_a_r0ck5tar</h1>

<h2 id="problem-15">Problem</h2>

<p>I wrote you another song. Put the flag in the picoCTF{} flag format</p>

<p><a href="/blog/picoctf-2019-writeup/general-skills/1_wanna_b3_a_r0ck5tar/lyrics.txt">file</a></p>

<h2 id="solution-15">Solution</h2>

<p>This time the program requires some input. We can simply remove these input checks to get to the flag.</p>

<p>Remove these lines:</p>

<pre><code>Listen to the music             
If the music is a guitar                  
Say &quot;Keep on rocking!&quot;                
Listen to the rhythm
If the rhythm without Music is nothing
...
Else Whisper &quot;That ain't it, Chief&quot;
</code></pre>

<p>Output:</p>

<pre><code>66
79
78
74
79
86
73
</code></pre>

<p>Converting it to ASCII:</p>

<pre><code>$ python
&gt;&gt;&gt; ''.join(map(chr,[66,79,78,74,79,86,73]))
'BONJOVI'
</code></pre>

<p>flag: <code>picoCTF{BONJOVI}</code></p>

                </section>
            </article>

            
                <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2ftcode2k16.github.io%2fblog%2fposts%2fpicoctf-2019-writeup%2fgeneral-skills%2f - PicoCTF%202019%20Writeup%3a%20General%20Skills by @tcode2k16"><span class="icon-twitter"> tweet</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Share</span>
</a>

            

            
                <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'github-blog-14'; 

     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

            

            

            <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://www.github.com/tcode2k16">
        <i class="fa fa-github-square"></i>
    </a>
    
    <a class="symbol" href="https://twitter.com/tcode2k16">
        <i class="fa fa-twitter-square"></i>
    </a>
    


</div>

    
    <p class="small">
    
       © Copyright 2019 <i class="fa fa-heart" aria-hidden="true"></i> Alan Chang
    
    </p>
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
    </p>
</footer>

        </section>

        <script src="https://tcode2k16.github.io/blog/js/jquery-3.3.1.min.js"></script>
<script src="https://tcode2k16.github.io/blog/js/main.js"></script>
<script src="https://tcode2k16.github.io/blog/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-88069322-2', 'auto');
	
	ga('send', 'pageview');
}
</script>





    </body>
</html>
